Discarded 6 diffused primitive functions, 0 contracted functions
#INFO: **** input file is /home/j1k/repositories/qmcpack_workshop_2019/day2_nexus/pyscf/04_pyscf_diamond_dft_qmc/runs/diamond/scf/scf.py ****
#!/usr/bin/env python

from pyscf.pbc import df, scf


### generated system text ###
from numpy import array
from pyscf.pbc import gto as gto_loc
cell = gto_loc.Cell()
cell.a             = '''
                     1.78500000   1.78500000   0.00000000
                     0.00000000   1.78500000   1.78500000
                     1.78500000   0.00000000   1.78500000
                     '''
cell.basis         = 'bfd-vdz'
cell.dimension     = 3
cell.ecp           = 'bfd'
cell.unit          = 'A'
cell.atom          = '''
                     C    0.00000000   0.00000000   0.00000000
                     C    0.89250000   0.89250000   0.89250000
                     '''
cell.drop_exponent = 0.1
cell.verbose       = 5
cell.charge        = 0
cell.spin          = 0
cell.build()
kpts = array([
    [0.0, 0.0, 0.0],
    [0.4656748546088228, 0.4656748546088228, -0.4656748546088228]])
### end generated system text ###



gdf = df.FFTDF(cell,kpts)
gdf.auxbasis = 'weigend'

mf = scf.KRHF(cell,kpts).density_fit()
mf.exxdiv  = 'ewald'
mf.with_df = gdf
mf.kernel()

### generated conversion text ###
from PyscfToQmcpack import savetoqmcpack
savetoqmcpack(cell,mf,'scf',kpts)
### end generated conversion text ###

#INFO: ******************** input file end ********************


System: ('Linux', 'viribus', '4.15.0-48-generic', '#51-Ubuntu SMP Wed Apr 3 08:28:49 UTC 2019', 'x86_64', 'x86_64')  Threads 16
Python 2.7.15rc1 (default, Nov 12 2018, 14:31:15) 
[GCC 7.3.0]
numpy 1.15.4  scipy 0.19.1
Date: Thu May  9 13:41:32 2019
PySCF version 1.5.4
PySCF path  /home/j1k/repositories/pyscf/pyscf
GIT HEAD      ref: refs/heads/master
GIT master branch  b10d0ee541f783312ac791d36702ff7a4bc1c637

[CONFIG] conf_file None
[INPUT] verbose = 5
[INPUT] max_memory = 4000 
[INPUT] num. atoms = 2
[INPUT] num. electrons = 8
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = A
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 C      0.892500000000   0.892500000000   0.892500000000 AA    1.686580566174   1.686580566174   1.686580566174 Bohr
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] C
[INPUT] 0    0    [8    /1   ]  13.073594         -0.000705
                                6.541187          0.015176
                                3.272791          -0.121499
                                1.637494          -0.033512
                                0.819297          0.180113
                                0.409924          0.380369
                                0.2051            0.397529
                                0.102619          0.169852
[INPUT] 0    0    [1    /1   ]  0.127852             1
[INPUT] 1    0    [7    /1   ]  7.480076          0.021931
                                3.741035          0.054425
                                1.871016          0.112024
                                0.935757          0.210979
                                0.468003          0.289868
                                0.234064          0.302667
                                0.117063          0.191634
[INPUT] 1    0    [1    /1   ]  0.149161             1
[INPUT] 2    0    [1    /1   ]  0.561161             1

Ewald components = 1.76043198403506e-15, -36.7282245445858, 23.9525572427489
nuclear repulsion = -12.7756673018369
number of shells = 10
number of NR pGTOs = 76
number of NR cGTOs = 26
basis = bfd-vdz
ecp = bfd
CPU time:         0.78
lattice vectors  a1 [3.373161132, 3.373161132, 0.000000000]
                 a2 [0.000000000, 3.373161132, 3.373161132]
                 a3 [3.373161132, 0.000000000, 3.373161132]
dimension = 3
Cell volume = 76.7611
exp_to_discard = 0.1
rcut = 19.243077142883383 (nimgs = [5 5 5])
lattice sum = 911 cells
precision = 1e-08
pseudo = None
ke_cutoff = 210.04046224479163
    = [26 26 26] mesh (17576 PWs)
ew_eta = 2.01651
ew_cut = 3.4228673507667566 (nimgs = [1 1 1])


******** <class 'pyscf.pbc.scf.khf.KRHF'> flags ********
method = KRHF-KSCF-SCF
initial guess = minao
damping factor = 0
level shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
DIIS start cycle = 1
DIIS space = 8
SCF tol = 1e-07
SCF gradient tol = None
max. SCF cycles = 50
direct_scf = False
chkfile to save SCF result = /home/j1k/repositories/qmcpack_workshop_2019/day2_nexus/pyscf/04_pyscf_diamond_dft_qmc/runs/diamond/scf/tmpNrA0HU
max_memory 4000 MB (current use 63 MB)


******** PBC SCF flags ********
N kpts = 2
kpts = [[ 0.          0.          0.        ]
 [ 0.46567485  0.46567485 -0.46567485]]
Exchange divergence treatment (exxdiv) = ewald
Ewald components = 2.3840572324607e-42, -1.14020834591461, 0.905546168994174
    madelung (= occupied orbital energy shift) = 0.4693243538408729
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung/cell.vol = -1.87729741536
DF object = <pyscf.pbc.df.fft.FFTDF object at 0x7fcf50fe9fd0>


******** <class 'pyscf.pbc.df.fft.FFTDF'> flags ********
mesh = [26 26 26] (17576 PWs)
len(kpts) = 2
Set gradient conv threshold to 0.000316228
cond(S) = [ 62153.80803905 147620.97792248]
Ewald components = 2.3840572324607e-42, -1.14020834591461, 0.905546168994174
    CPU time for vj and vk     28.66 sec, wall time      4.04 sec
E1 = (3.7539157568910086+1.0807851671650307e-23j)  E_coul = (-6.8215376605416145-7.486264615390734e-16j)
Ewald components = 1.76043198403506e-15, -36.7282245445858, 23.9525572427489
init E= -15.8432892054875
    CPU time for initialize scf    190.57 sec, wall time     17.91 sec
HOMO = 0.605992054122  LUMO = 0.795727199255
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-2.20368497  0.55106648  0.60595023  0.60599205] [0.7957272  0.8744905  0.87453101 1.07840682 1.58066068 1.77502173
 1.77502173 2.14365049 2.16276295 2.16286845 2.6443329  2.64957963
 2.64977303 3.4121328  3.61032448 3.61042002 3.61215969 3.65261214
 3.65261215 4.71732125 4.71899246 4.7190097 ]
   1 ( 0.500  0.000  0.000)   [-1.03673356 -0.69000512  0.45556212  0.45559808] [ 0.92340365  1.00832706  1.00836524  1.32288742  1.61382942  1.71956891
  1.82501668  1.82509734  2.09546408  2.09547099  2.92347923  3.06773869
  3.06793138  3.08967331  3.08973933  3.16048531  3.75445062  3.75454193
  3.78470053  3.78470473  4.04476394 10.7952289 ]
Ewald components = 2.3840572324607e-42, -1.14020834591461, 0.905546168994174
    CPU time for vj and vk     12.41 sec, wall time      1.25 sec
E1 = (4.423615725769092+1.44724295454102e-23j)  E_coul = (-2.240044894975314-6.226899756170634e-16j)
Ewald components = 1.76043198403506e-15, -36.7282245445858, 23.9525572427489
cycle= 1 E= -10.5920964710431  delta_E= 5.25  |g|= 0.282  |ddm|= 5.56
    CPU time for cycle= 1     12.44 sec, wall time      1.27 sec
HOMO = 0.35285172112  LUMO = 1.00748389043
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65683972  0.27660136  0.27664691  0.35285172] [1.00748389 1.0275664  1.02760365 1.33389347 1.64389111 1.81909278
 1.81909465 2.21877153 2.22688544 2.22699501 2.7073429  2.70754652
 2.71363239 3.42644149 3.63034989 3.63592446 3.63601648 3.6980958
 3.69809638 4.75435714 4.75946367 4.75947942]
   1 ( 0.500  0.000  0.000)   [-0.3759848  -0.26168816  0.16152912  0.16156902] [ 1.1357979   1.16070559  1.16073906  1.39933466  1.69688423  1.79826254
  1.86950638  1.86959059  2.12764158  2.12764776  2.97838593  3.12376502
  3.12383313  3.13473234  3.13492547  3.18855042  3.7917602   3.79185292
  3.8143514   3.8143573   4.08296141 10.91178121]
Ewald components = 2.3840572324607e-42, -1.14020834591461, 0.905546168994174
    CPU time for vj and vk     12.39 sec, wall time      1.23 sec
E1 = (4.405508321812571+1.430117730921758e-23j)  E_coul = (-2.2327437583185126-6.626657501493804e-16j)
Ewald components = 1.76043198403506e-15, -36.7282245445858, 23.9525572427489
cycle= 2 E= -10.6029027383429  delta_E= -0.0108  |g|= 0.0628  |ddm|=  1.4
    CPU time for cycle= 2     12.42 sec, wall time      1.24 sec
HOMO = 0.344670682282  LUMO = 1.01404802298
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65354876  0.2785266   0.27857214  0.34467068] [1.01404802 1.0338883  1.03392537 1.34183358 1.64366835 1.8211898
 1.82119185 2.22222589 2.22936807 2.22947822 2.71032707 2.71053185
 2.71508301 3.4237721  3.63147931 3.63665342 3.63674541 3.70118162
 3.7011821  4.75735662 4.76186707 4.7618826 ]
   1 ( 0.500  0.000  0.000)   [-0.37445852 -0.26338935  0.1652353   0.16527533] [ 1.13888999  1.16488799  1.16492102  1.40137458  1.69929422  1.800216
  1.87175224  1.871837    2.1277044   2.12771064  2.98078099  3.12634455
  3.12641264  3.13904189  3.13923542  3.1904203   3.79444673  3.79453924
  3.8153568   3.81536291  4.08509401 10.91692153]
Ewald components = 2.3840572324607e-42, -1.14020834591461, 0.905546168994174
    CPU time for vj and vk     12.31 sec, wall time      1.23 sec
E1 = (4.4041954559860885+1.47793911008498e-23j)  E_coul = (-2.232050582156054-6.39648273884174e-16j)
Ewald components = 1.76043198403506e-15, -36.7282245445858, 23.9525572427489
cycle= 3 E= -10.6035224280069  delta_E= -0.00062  |g|= 0.00368  |ddm|= 0.24
    CPU time for cycle= 3     12.35 sec, wall time      1.25 sec
HOMO = 0.344765598507  LUMO = 1.0137453046
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65362553  0.27816791  0.27821347  0.3447656 ] [1.0137453  1.03368466 1.03372176 1.34117587 1.64377668 1.82102515
 1.82102719 2.22195414 2.22922662 2.22933674 2.7099155  2.71012018
 2.71478158 3.4238594  3.6314505  3.63650259 3.63659453 3.70102823
 3.70102874 4.75719564 4.76167207 4.76168759]
   1 ( 0.500  0.000  0.000)   [-0.37462679 -0.26297384  0.16501536  0.16505542] [ 1.13844806  1.16460512  1.16463818  1.40137386  1.69877826  1.80003599
  1.87151399  1.87159876  2.12781224  2.12781843  2.9807238   3.12606872
  3.12613671  3.13861361  3.13880721  3.19016087  3.79417993  3.79427242
  3.81517725  3.81518337  4.08485719 10.91579994]
Ewald components = 2.3840572324607e-42, -1.14020834591461, 0.905546168994174
    CPU time for vj and vk     12.44 sec, wall time      1.24 sec
E1 = (4.404281282945426+1.3402910862773277e-23j)  E_coul = (-2.2321386399942575-6.458630999434726e-16j)
Ewald components = 1.76043198403506e-15, -36.7282245445858, 23.9525572427489
cycle= 4 E= -10.6035246588857  delta_E= -2.23e-06  |g|= 0.000582  |ddm|= 0.0479
    CPU time for cycle= 4     12.48 sec, wall time      1.25 sec
HOMO = 0.344767369285  LUMO = 1.01376458566
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.6536382   0.27818454  0.27823009  0.34476737] [1.01376459 1.03371868 1.03375577 1.34118211 1.64378113 1.82104006
 1.82104209 2.22198903 2.22924498 2.22935511 2.70994673 2.7101514
 2.71480969 3.42384219 3.63145946 3.63651343 3.63660537 3.70105137
 3.70105187 4.75722077 4.76169142 4.76170694]
   1 ( 0.500  0.000  0.000)   [-0.3746209  -0.26300953  0.16502582  0.16506588] [ 1.13843096  1.16463667  1.16466973  1.40138899  1.69881706  1.8000375
  1.87153038  1.87161516  2.12782374  2.12782993  2.98077316  3.12608725
  3.12615528  3.13865201  3.13884555  3.19018524  3.79420548  3.79429798
  3.81518501  3.81519113  4.08486976 10.91584974]
Ewald components = 2.3840572324607e-42, -1.14020834591461, 0.905546168994174
    CPU time for vj and vk     12.38 sec, wall time      1.24 sec
E1 = (4.404249669690674+1.376157120649744e-23j)  E_coul = (-2.2321071025092145-6.408688824088585e-16j)
Ewald components = 1.76043198403506e-15, -36.7282245445858, 23.9525572427489
cycle= 5 E= -10.6035247346555  delta_E= -7.58e-08  |g|= 9.06e-05  |ddm|= 0.00541
    CPU time for cycle= 5     12.42 sec, wall time      1.26 sec
HOMO = 0.344776988644  LUMO = 1.01376242531
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.65363588  0.27818302  0.27822857  0.34477699] [1.01376243 1.03371784 1.03375494 1.34117456 1.6437811  1.82103909
 1.82104112 2.2219844  2.22924445 2.22935458 2.70994527 2.71014994
 2.7148094  3.42384357 3.63145938 3.63651268 3.63660462 3.7010502
 3.7010507  4.75721961 4.76169016 4.76170568]
   1 ( 0.500  0.000  0.000)   [-0.37461786 -0.26299292  0.16502674  0.1650668 ] [ 1.1384222   1.16463302  1.16466608  1.40138507  1.69881006  1.80003595
  1.87153028  1.87161506  2.12782736  2.12783355  2.98077738  3.12608362
  3.12615162  3.13864903  3.1388426   3.19018138  3.79420372  3.79429622
  3.81518308  3.8151892   4.08486649 10.91584668]
Ewald components = 2.3840572324607e-42, -1.14020834591461, 0.905546168994174
    CPU time for vj and vk     12.38 sec, wall time      1.23 sec
E1 = (4.404246971279713+1.3047481693316897e-23j)  E_coul = (-2.232104405528119-6.663323484505552e-16j)
Ewald components = 1.76043198403506e-15, -36.7282245445858, 23.9525572427489
Extra cycle  E= -10.6035247360853  delta_E= -1.43e-09  |g|= 2.91e-05  |ddm|= 0.000541
    CPU time for scf_cycle    265.09 sec, wall time     25.43 sec
    CPU time for SCF    265.17 sec, wall time     25.43 sec
converged SCF energy = -10.6035247360853
Using Python 2.x
Wavefunction successfully saved to QMCPACK HDF5 Format
Use: "convert4qmc -pyscf  scf.h5" to generate QMCPACK input files
