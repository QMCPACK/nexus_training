#INFO: **** input file is /home/j1k/repositories/qmcpack_workshop_2019/day2_nexus/pyscf/03_pyscf_h2o_hf_qmc/runs/H2O/hf/scf.py ****
#! /usr/bin/env python

from pyscf import scf

# Nexus expands this with Mole info

### generated system text ###
from pyscf import gto as gto_loc
mol = gto_loc.Mole()
mol.verbose  = 5
mol.atom     = '''
               O    0.00000000   0.00000000   0.00000000
               H    0.00000000   0.75716000   0.58626000
               H    0.00000000   0.75716000  -0.58626000
               '''
mol.basis    = 'ccpvtz'
mol.unit     = 'A'
mol.charge   = 0
mol.spin     = 0
mol.symmetry = True
mol.build()
### end generated system text ###



mf = scf.RHF(mol)
mf.kernel()

### generated conversion text ###
from PyscfToQmcpack import savetoqmcpack
savetoqmcpack(mol,mf,'scf')
### end generated conversion text ###

#INFO: ******************** input file end ********************


System: ('Linux', 'viribus', '4.15.0-48-generic', '#51-Ubuntu SMP Wed Apr 3 08:28:49 UTC 2019', 'x86_64', 'x86_64')  Threads 1
Python 2.7.15rc1 (default, Nov 12 2018, 14:31:15) 
[GCC 7.3.0]
numpy 1.15.4  scipy 0.19.1
Date: Wed May  8 12:53:04 2019
PySCF version 1.5.4
PySCF path  /home/j1k/repositories/pyscf/pyscf
GIT HEAD      ref: refs/heads/master
GIT master branch  b10d0ee541f783312ac791d36702ff7a4bc1c637

[CONFIG] conf_file None
[INPUT] verbose = 5
[INPUT] max_memory = 4000 
[INPUT] num. atoms = 3
[INPUT] num. electrons = 10
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry True subgroup None
[INPUT] Mole.unit = A
[INPUT]  1 O      0.000000000000   0.000000000000  -0.151432000000 AA    0.000000000000   0.000000000000  -0.286165006495 Bohr
[INPUT]  2 H      0.000000000000   0.586260000000   0.605728000000 AA    0.000000000000   1.107870837788   1.144660025981 Bohr
[INPUT]  3 H      0.000000000000  -0.586260000000   0.605728000000 AA    0.000000000000  -1.107870837788   1.144660025981 Bohr
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] H
[INPUT] 0    0    [3    /1   ]  33.87             0.006068
                                5.095             0.045308
                                1.159             0.202822
[INPUT] 0    0    [1    /1   ]  0.3258               1
[INPUT] 0    0    [1    /1   ]  0.1027               1
[INPUT] 1    0    [1    /1   ]  1.407                1
[INPUT] 1    0    [1    /1   ]  0.388                1
[INPUT] 2    0    [1    /1   ]  1.057                1
[INPUT] O
[INPUT] 0    0    [8    /2   ]  15330             0.000508 -0.000115
                                2299              0.003929 -0.000895
                                522.4             0.020243 -0.004636
                                147.3             0.079181 -0.018724
                                47.55             0.230687 -0.058463
                                16.76             0.433118 -0.136463
                                6.207             0.35026 -0.17574
                                0.6882            -0.008154 0.603418
[INPUT] 0    0    [1    /1   ]  1.752                1
[INPUT] 0    0    [1    /1   ]  0.2384               1
[INPUT] 1    0    [3    /1   ]  34.46             0.015928
                                7.749             0.09974
                                2.28              0.310492
[INPUT] 1    0    [1    /1   ]  0.7156               1
[INPUT] 1    0    [1    /1   ]  0.214                1
[INPUT] 2    0    [1    /1   ]  2.314                1
[INPUT] 2    0    [1    /1   ]  0.645                1
[INPUT] 3    0    [1    /1   ]  1.428                1

nuclear repulsion = 9.2930681548542
point group symmetry = C2v
num. orbitals of irrep A1 = 23
num. orbitals of irrep A2 = 7
num. orbitals of irrep B1 = 11
num. orbitals of irrep B2 = 17
number of shells = 21
number of NR pGTOs = 74
number of NR cGTOs = 58
basis = ccpvtz
ecp = {}
CPU time:         0.10


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> flags ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
DIIS start cycle = 1
DIIS space = 8
SCF tol = 1e-09
SCF gradient tol = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/j1k/repositories/qmcpack_workshop_2019/day2_nexus/pyscf/03_pyscf_h2o_hf_qmc/runs/H2O/hf/tmpjSPV_L
max_memory 4000 MB (current use 55 MB)
Freeze 0 electrons in irreps []
    10 free electrons in irreps A1 A2 B1 B2
Set gradient conv threshold to 3.16228e-05
cond(S) = 2109.0399352381282
E_coul = 36.6620888752896
init E= -75.9227612544119
    CPU time for initialize scf      0.06 sec, wall time      0.06 sec
HOMO (B1) = -0.479534916770199  LUMO (A1) = 0.071514740863777
irrep_nelec = [6, 0, 2, 2]
A1 nocc = 3  HOMO = -0.660484551673932  LUMO = 0.071514740863777
   mo_energy = [-20.77894572  -1.65215424  -0.66048455   0.07151474   0.53817662
   0.59695258   0.79142197   1.0581698    1.56501683   1.93213103
   2.09286007   2.81158418   3.21138169   3.86159252   4.06799833
   4.51629775   5.07368765   5.12737123   6.52825159   6.76725983
   7.21405372   7.43221425  12.83977232]
A2 nocc = 0
   mo_energy = [0.92373625 1.91185748 3.78927313 4.02612781 4.48785055 6.70740217
 7.00318545]
B1 nocc = 1  HOMO = -0.479534916770199  LUMO = 0.704901298460691
   mo_energy = [-0.47953492  0.7049013   0.83119673  2.00891654  3.11108807  3.6352943
  3.99939232  4.52677354  5.77732718  6.76692844  6.96218014]
B2 nocc = 1  HOMO = -0.65802738007009  LUMO = 0.179953370907483
   mo_energy = [-0.65802738  0.17995337  0.46535751  0.7520008   1.27115094  1.47923696
  2.01883351  2.88847023  3.77097254  3.96204244  4.04128858  4.76252972
  5.12157973  5.61322658  6.4510089   7.65044398  8.22593566]
E_coul = 38.8503163129899
cycle= 1 E= -75.9856353039539  delta_E= -0.0629  |g|= 0.476  |ddm|= 1.01
    CPU time for cycle= 1      0.01 sec, wall time      0.01 sec
HOMO (B1) = -0.434682744528448  LUMO (A1) = 0.124590396652987
irrep_nelec = [6, 0, 2, 2]
A1 nocc = 3  HOMO = -0.56287763752258  LUMO = 0.124590396652987
   mo_energy = [-20.33154306  -1.31757706  -0.56287764   0.1245904    0.59949901
   0.69817538   0.78060768   1.20607184   1.60802607   2.06619566
   2.23520809   2.80724263   3.20347517   3.91464313   4.0982634
   4.48266923   5.19808987   5.33256315   6.72455711   7.055483
   7.46785916   7.65596571  13.04587328]
A2 nocc = 0
   mo_energy = [0.9163106  2.05743889 3.75881367 4.01821903 4.46436464 6.99287316
 7.2246002 ]
B1 nocc = 1  HOMO = -0.434682744528448  LUMO = 0.805506614693877
   mo_energy = [-0.43468274  0.80550661  0.85937333  2.15284284  3.09481368  3.75936928
  4.00599871  4.68679997  6.00379993  7.01910231  7.21196709]
B2 nocc = 1  HOMO = -0.598888133827769  LUMO = 0.204791473180088
   mo_energy = [-0.59888813  0.20479147  0.51895608  0.85395554  1.2549815   1.49532829
  2.08198108  2.97938187  3.79463546  3.91834461  4.03982681  4.8441533
  5.23550208  5.70907792  6.5912875   7.90390864  8.39541091]
E_coul = 37.1044942334018
cycle= 2 E= -76.017690444708  delta_E= -0.0321  |g|= 0.285  |ddm|= 0.371
    CPU time for cycle= 2      0.01 sec, wall time      0.01 sec
HOMO (B1) = -0.52264114230912  LUMO (A1) = 0.127059253896437
irrep_nelec = [6, 0, 2, 2]
A1 nocc = 3  HOMO = -0.647517544322332  LUMO = 0.127059253896437
   mo_energy = [-20.60221182  -1.3873887   -0.64751754   0.12705925   0.59559515
   0.66184106   0.78979596   1.14766142   1.59472469   2.01488872
   2.18320338   2.8216931    3.21809381   3.90319199   4.08175621
   4.49809319   5.15004116   5.23548081   6.64033      6.91919141
   7.35208941   7.55447331  12.93795022]
A2 nocc = 0
   mo_energy = [0.92413889 2.00224921 3.78704953 4.02817149 4.48272099 6.86268357
 7.12983982]
B1 nocc = 1  HOMO = -0.52264114230912  LUMO = 0.774943940380637
   mo_energy = [-0.52264114  0.77494394  0.84642577  2.09974683  3.11318566  3.71747413
  3.99867577  4.61449422  5.91179113  6.91080234  7.10019073]
B2 nocc = 1  HOMO = -0.658589726130241  LUMO = 0.205472884700275
   mo_energy = [-0.65858973  0.20547288  0.51240221  0.81956204  1.26356759  1.48873922
  2.06083353  2.94882247  3.79439445  3.94592149  4.03383771  4.80727836
  5.19031889  5.67541781  6.5307994   7.78675111  8.32071649]
E_coul = 37.9358370498401
cycle= 3 E= -76.0300140794948  delta_E= -0.0123  |g|= 0.0348  |ddm|= 0.116
    CPU time for cycle= 3      0.01 sec, wall time      0.01 sec
HOMO (B1) = -0.511567622040366  LUMO (A1) = 0.13167306913944
irrep_nelec = [6, 0, 2, 2]
A1 nocc = 3  HOMO = -0.63739590050172  LUMO = 0.13167306913944
   mo_energy = [-20.56492794  -1.3720718   -0.6373959    0.13167307   0.60562685
   0.6629428    0.7974822    1.15216558   1.60664305   2.02359371
   2.19072808   2.83470118   3.2312423    3.91489842   4.09538324
   4.51006598   5.16668773   5.25006192   6.65742075   6.93871625
   7.36987287   7.56783141  12.96049267]
A2 nocc = 0
   mo_energy = [0.931107   2.0099455  3.80111    4.03888169 4.49508365 6.88220315
 7.14159769]
B1 nocc = 1  HOMO = -0.511567622040366  LUMO = 0.781521737190007
   mo_energy = [-0.51156762  0.78152174  0.85176028  2.10795931  3.12537125  3.73340195
  4.01108351  4.62877228  5.92439244  6.93119814  7.11257495]
B2 nocc = 1  HOMO = -0.645313237097902  LUMO = 0.209575694091638
   mo_energy = [-0.64531324  0.20957569  0.51908222  0.82445271  1.26943485  1.49730619
  2.06743805  2.95963087  3.80729404  3.9579401   4.0470135   4.82180948
  5.20630506  5.68883146  6.54371038  7.80177847  8.34159368]
E_coul = 37.8515319312723
cycle= 4 E= -76.0302500035014  delta_E= -0.000236  |g|= 0.0071  |ddm|= 0.0191
    CPU time for cycle= 4      0.01 sec, wall time      0.01 sec
HOMO (B1) = -0.512565772905725  LUMO (A1) = 0.131959764959345
irrep_nelec = [6, 0, 2, 2]
A1 nocc = 3  HOMO = -0.637547312134557  LUMO = 0.131959764959345
   mo_energy = [-20.56562847  -1.37217939  -0.63754731   0.13195976   0.606243
   0.66290838   0.79817189   1.15227531   1.60718696   2.02404476
   2.19074643   2.83624727   3.23225932   3.91612813   4.09666786
   4.51165959   5.16732264   5.25054657   6.65776648   6.93842387
   7.36996408   7.56847919  12.9605891 ]
A2 nocc = 0
   mo_energy = [0.93167013 2.01014211 3.80263883 4.040016   4.49629873 6.8818214
 7.14207118]
B1 nocc = 1  HOMO = -0.512565772905725  LUMO = 0.781075247575085
   mo_energy = [-0.51256577  0.78107525  0.8522266   2.10820792  3.1264464   3.73393527
  4.01232622  4.62887428  5.9243458   6.93117511  7.11315302]
B2 nocc = 1  HOMO = -0.644537031549537  LUMO = 0.210250253073654
   mo_energy = [-0.64453703  0.21025025  0.51964898  0.82496261  1.27020353  1.49819678
  2.06770561  2.96075681  3.8084395   3.95958317  4.04869873  4.82283944
  5.20666609  5.68953957  6.54424485  7.80230082  8.34224012]
E_coul = 37.8544650951836
cycle= 5 E= -76.030276710572  delta_E= -2.67e-05  |g|= 0.0016  |ddm|= 0.00982
    CPU time for cycle= 5      0.01 sec, wall time      0.01 sec
HOMO (B1) = -0.512983277026977  LUMO (A1) = 0.131849538208121
irrep_nelec = [6, 0, 2, 2]
A1 nocc = 3  HOMO = -0.637879165628831  LUMO = 0.131849538208121
   mo_energy = [-20.56626098  -1.37236729  -0.63787917   0.13184954   0.60603088
   0.66281749   0.79800869   1.15217343   1.6070066    2.02382365
   2.1905931    2.8360973    3.2320538    3.91592425   4.0964683
   4.51155329   5.16709147   5.25030505   6.65752755   6.93797779
   7.36966279   7.56817139  12.96026603]
A2 nocc = 0
   mo_energy = [0.93156111 2.00996376 3.80247778 4.03983589 4.49618365 6.88144482
 7.14178643]
B1 nocc = 1  HOMO = -0.512983277026977  LUMO = 0.780775855772128
   mo_energy = [-0.51298328  0.78077586  0.85216519  2.10803332  3.12626693  3.73365764
  4.01217267  4.62867993  5.92401703  6.93091733  7.11293015]
B2 nocc = 1  HOMO = -0.644372326305668  LUMO = 0.210271811368637
   mo_energy = [-0.64437233  0.21027181  0.51947397  0.82496532  1.27009752  1.49812765
  2.06757027  2.96056433  3.80823233  3.95943221  4.04860465  4.82262244
  5.206425    5.6893164   6.54388583  7.80193149  8.34193913]
E_coul = 37.8552420401525
cycle= 6 E= -76.0302783271128  delta_E= -1.62e-06  |g|= 0.000264  |ddm|= 0.00235
    CPU time for cycle= 6      0.01 sec, wall time      0.01 sec
HOMO (B1) = -0.513057585111576  LUMO (A1) = 0.131835455382783
irrep_nelec = [6, 0, 2, 2]
A1 nocc = 3  HOMO = -0.637959534044175  LUMO = 0.131835455382783
   mo_energy = [-20.56629871  -1.3724027   -0.63795953   0.13183546   0.60602093
   0.66279369   0.79798844   1.15215353   1.60699035   2.02379563
   2.19056154   2.83608588   3.23203976   3.91590336   4.09644778
   4.51154475   5.16706933   5.25027257   6.65750087   6.9379271
   7.36962653   7.56814643  12.96023912]
A2 nocc = 0
   mo_energy = [0.93154546 2.00993125 3.80246705 4.03981559 4.49617727 6.88139197
 7.14174771]
B1 nocc = 1  HOMO = -0.513057585111576  LUMO = 0.780744755293988
   mo_energy = [-0.51305759  0.78074476  0.85215414  2.10800186  3.12625331  3.73362946
  4.01215564  4.62864639  5.92396674  6.9308862   7.11289913]
B2 nocc = 1  HOMO = -0.644357919121812  LUMO = 0.210286576664343
   mo_energy = [-0.64435792  0.21028658  0.51947281  0.82497934  1.27008922  1.49813102
  2.0675558   2.96054588  3.80821449  3.95941969  4.0486005   4.82260331
  5.2064016   5.68928514  6.54384449  7.80189893  8.3419124 ]
E_coul = 37.8552303463095
cycle= 7 E= -76.0302783706002  delta_E= -4.35e-08  |g|= 3.66e-05  |ddm|= 0.000514
    CPU time for cycle= 7      0.01 sec, wall time      0.01 sec
HOMO (B1) = -0.513050475726253  LUMO (A1) = 0.131834663962588
irrep_nelec = [6, 0, 2, 2]
A1 nocc = 3  HOMO = -0.637960414814851  LUMO = 0.131834663962588
   mo_energy = [-20.56629623  -1.37239921  -0.63796041   0.13183466   0.60601928
   0.66279257   0.79798837   1.15215383   1.60698945   2.0237974
   2.19056247   2.83608559   3.23203986   3.9159042    4.09644726
   4.51154465   5.1670704    5.25027429   6.6575034    6.93792988
   7.36962978   7.56815139  12.96024054]
A2 nocc = 0
   mo_energy = [0.93154491 2.00993322 3.80246676 4.03981568 4.49617804 6.88139401
 7.14175052]
B1 nocc = 1  HOMO = -0.513050475726253  LUMO = 0.78074569166958
   mo_energy = [-0.51305048  0.78074569  0.85215349  2.10800352  3.12625343  3.73363076
  4.01215555  4.62864734  5.92396863  6.93088941  7.11290276]
B2 nocc = 1  HOMO = -0.644344744885448  LUMO = 0.210287686690767
   mo_energy = [-0.64434474  0.21028769  0.51947224  0.82498195  1.27008964  1.4981312
  2.06755719  2.960547    3.808215    3.95941897  4.04860082  4.82260426
  5.20640312  5.68928533  6.54384555  7.80190332  8.34191445]
E_coul = 37.8552372334172
cycle= 8 E= -76.0302783714177  delta_E= -8.18e-10  |g|= 6.4e-06  |ddm|= 5.28e-05
    CPU time for cycle= 8      0.01 sec, wall time      0.01 sec
HOMO (B1) = -0.513049728171529  LUMO (A1) = 0.131834504413388
irrep_nelec = [6, 0, 2, 2]
A1 nocc = 3  HOMO = -0.637961639144091  LUMO = 0.131834504413388
   mo_energy = [-20.56629747  -1.37239963  -0.63796164   0.1318345    0.60601923
   0.66279295   0.79798811   1.15215423   1.60698909   2.02379764
   2.19056283   2.83608527   3.2320395    3.91590415   4.09644654
   4.511544     5.16707023   5.25027423   6.65750342   6.93792989
   7.36962987   7.56815177  12.96024009]
A2 nocc = 0
   mo_energy = [0.93154463 2.00993358 3.80246631 4.03981534 4.49617768 6.88139392
 7.14175078]
B1 nocc = 1  HOMO = -0.513049728171529  LUMO = 0.780746777475562
   mo_energy = [-0.51304973  0.78074678  0.85215344  2.10800389  3.12625312  3.73363085
  4.01215502  4.62864733  5.92396897  6.93088936  7.112903  ]
B2 nocc = 1  HOMO = -0.644346177572711  LUMO = 0.210287630241786
   mo_energy = [-0.64434618  0.21028763  0.51947269  0.8249822   1.27008928  1.49813101
  2.0675573   2.960547    3.80821476  3.9594182   4.04860022  4.82260387
  5.20640309  5.68928516  6.54384561  7.80190358  8.34191442]
E_coul = 37.855238842668
Extra cycle  E= -76.0302783714398  delta_E= -2.22e-11  |g|= 2.7e-06  |ddm|= 6.71e-06
    CPU time for scf_cycle      0.13 sec, wall time      0.13 sec
    CPU time for SCF      0.13 sec, wall time      0.13 sec
converged SCF energy = -76.0302783714398
Using Python 2.x
Wavefunction successfully saved to QMCPACK HDF5 Format
Use: "convert4qmc -pyscf  scf.h5" to generate QMCPACK input files
